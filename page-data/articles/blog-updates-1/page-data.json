{"componentChunkName":"component---src-templates-article-page-template-tsx","path":"/articles/blog-updates-1","result":{"pageContext":{"id":"blog-updates-1","lang":"cn","htmlAst":{"type":"root","children":[{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"前言"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"不知不觉，Gatsby博客已经上线了一年多。在这一年中，虽然从表面看起来博客变化不大，但是我一直在对博客做一些更新工作。特别是最近一个月，我对博客一些耽搁已久的问题进行了解决，使整个博客更加的完善了。这篇简单的文章就简地列举一下最近博客一些特别值得提到的更新，目前存在的问题，以及对博客的未来发展做一些展望和规划。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"更新"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"RSS恢复支持"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"博客的RSS源地址是："},{"type":"element","tagName":"a","properties":{"href":"https://ddadaal.me/rss.xml"},"children":[{"type":"text","value":"https://ddadaal.me/rss.xml"}]},{"type":"text","value":"。欢迎订阅！"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"其实博客从很早开始（具体来说，从去年10月的"},{"type":"element","tagName":"a","properties":{"href":"https://github.com/vicblog/VicBlog-Gatsby/commit/e2e469ae05646590c0a05755e4e23f384102120d#diff-b9e136416b90437fa1dac910280b45fc"},"children":[{"type":"text","value":"e2e469"}]},{"type":"text","value":"开始）就已经加入了RSS支持，但是那时候的代码就是随便从网上抄了一段，没有对博客比较特殊的地方（例如说多语言的支持，存在不能显示在列表中的文章等）进行定制，后面对博客一些更新的时候也都直接放弃了RSS。这几天，我针对博客的RSS的功能进行了一些修复，包括："},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"修复文章中不合法的日期串"}]},{"type":"text","value":"、"},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"RSS项中的原文链接变成绝对地址而不是相对地址"}]},{"type":"text","value":"，"},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"重新修改序列化方法"}]},{"type":"text","value":"等，使得博客的RSS功能基本上可以正常使用了。博客的RSS源地址也在"},{"type":"element","tagName":"a","properties":{"href":"https://validator.w3.org/feed/"},"children":[{"type":"text","value":"W3C的Feed Validation Service"}]},{"type":"text","value":"中成功认证，对于大多数RSS阅读器来说已经可以正常使用了。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[]},{"type":"element","tagName":"figure","properties":{"className":["gatsby-resp-image-figure"],"style":""},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1055px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 32.631578947368425%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABHklEQVQoz42PO0sDQRSF5w/ZR60tU6TQVi3tJAGbYJciERQLzUKQ6BL0B+haxMYsWGhhZav2CTi70X3P7B7vzj4IYQUvfJw7Z869zDDDfIN++4LOxSN6lxMc6SZ6VxN0qe+SHvYf0D4bo33+N2mmdXIP/e4V7MZ4RmcwxsbeEI3WCJsH10obzRHq+zrWdjTUtvtYXaCWU5zXdzWsbJ2ieWyAfTsB5o4PxwsVP26gcPwoU/Jc6tNzce8FESHKmcwP4ZPHsFxJrPA9F2HgK03xCCmFinBu4YuoKiaTBCKWEBSO47hECEGezDRHkp9QPggjRdovwyzrE9z+gBfO8Z9Kh6r68oXTJw3v5gA2t2Fxjtl0Rl/ieTipfEVBsXRx8S+PBvADZuYqDQAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"有效性认证","title":"有效性认证","src":"/static/8f4cd200f9a1b8c4d2f424d20eddfedf/a2c78/rss-valid.png","srcSet":["/static/8f4cd200f9a1b8c4d2f424d20eddfedf/5459c/rss-valid.png 285w","/static/8f4cd200f9a1b8c4d2f424d20eddfedf/2cee3/rss-valid.png 570w","/static/8f4cd200f9a1b8c4d2f424d20eddfedf/a2c78/rss-valid.png 1055w"],"sizes":["(max-width:","1055px)","100vw,","1055px"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy"},"children":[]},{"type":"text","value":"\n    "}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"figcaption","properties":{"className":["gatsby-resp-image-figcaption"]},"children":[{"type":"text","value":"有效性认证"}]},{"type":"text","value":"\n  "}]},{"type":"element","tagName":"p","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[]},{"type":"element","tagName":"figure","properties":{"className":["gatsby-resp-image-figure"],"style":""},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1140px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 77.54385964912281%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC20lEQVQ4y41USWtTURh9GZq0GUqGmg5p2owkeclLmnTIVNKBZrANKQV/gBst2K4qggpdKIgLQdy4UItILVhFUKipisNGrBPFhYputFVLEXQjxfXxfVdfmjQVDBy++4b75XznnPs4PsDD5XLB6XTC2t4OrU4HjVYLmUwGjuNYldYSKp/V1dUx1NfXQyvu4xKJBOIievv6wPMBGMwWGPc079pIqVRCLpdX3ZMa0trtdoPLZDLI5XKgmkwmodPrqzYQVCoV1Gq1yF7PQGzomu5Xvhft7gE3NDSEkZERZLNZpPr7MX/pAu7eWcL81WuYX1jAwEAa7aIU9O8+nw+hkABBENi6s7OTjanRaBjzSFcE3PDwMGPHGqaSWFtbB/0+rW/i+4+fmJ6aQkdHByKRCKLRKGKxGFuHw2FRIh5erxfBYJB50JeI/WEoNaSRv25ssIYfv3zD1tYvTE5OoqmpiW0k86gSW4fDAZvNxp6ZTCaoxfGFaKi6IRm0XFpC6eEKLi+W8Hr1FYrj4zAajWhpaWFobW1l1Ww2s3HJEMkoPhTYHpmMicfjMImbNVo95EoV9KJBtImqxWJBW1sbrFYra0rMGhsbmUHKvy4Hu4RqDSWXFXJZVeYklxsaGsqga2JWGS8+HKjV8MjsKcyePoejJ89g5vgJ+ANBmEWNLM3NZZakHelGuVQoFKxSw0A4uEPDZAJzi0u4/XgVy0/f4v7zdyhM7IPTYWeOkhkSPB4Pi4/dbodXjJDH7UEsFa9lePbiAuaul3Dz3gpuPXqJ7Ni4qKGO6SVpKukqwWAwsHvh7q5aU85fuYEHLz7gyZvPePZ+E7nCRM3J+Rd8Ar/NkBpSaDN7x7D/4BQOTB/GoZlj6HC42MuVBuyGcmxyuTxy4riFQgHpdJoF9H8Z7QRzuVgsIp/PY3R0FIODgxC6Ewj1puAVeuDwCuInzcZyRzpR9ugYkssUbjpufr8fBqOhzPA3Jc/p4wisMuoAAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"文章列表（Newsflow UWP应用）","title":"文章列表（Newsflow UWP应用）","src":"/static/7aa942454f7ba7cfde5a06f2384c85a4/267c0/rss-list.png","srcSet":["/static/7aa942454f7ba7cfde5a06f2384c85a4/5459c/rss-list.png 285w","/static/7aa942454f7ba7cfde5a06f2384c85a4/2cee3/rss-list.png 570w","/static/7aa942454f7ba7cfde5a06f2384c85a4/267c0/rss-list.png 1140w","/static/7aa942454f7ba7cfde5a06f2384c85a4/96c58/rss-list.png 1216w"],"sizes":["(max-width:","1140px)","100vw,","1140px"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy"},"children":[]},{"type":"text","value":"\n    "}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"figcaption","properties":{"className":["gatsby-resp-image-figcaption"]},"children":[{"type":"text","value":"文章列表（Newsflow UWP应用）"}]},{"type":"text","value":"\n  "}]},{"type":"element","tagName":"p","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[]},{"type":"element","tagName":"figure","properties":{"className":["gatsby-resp-image-figure"],"style":""},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1140px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 77.54385964912281%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAACwElEQVQ4y42Uy08aURTGh4cIgm8FVBBQEQEBoVoeaogGhUTjn9CibtjYpLZJ0/SfcNl20S676NJtky6lmMZoG1qTavrYSGsovgpK6tc5pxlTwbSd5OS7c+fM737n3LkjuNwu9Pb2oqenB11dJmg0GqhUKgiC8F9RW1vLoVarodPpIITDYYTEGBkZweDgIMzd3QxvaWnhBKPRiLa2NnR2dkKv18NgMKC5uZnHBKqpqWEluNVmgzA1NYV4PA7SSCQCi9XKq5FL0vr6emi1WjQ0NLDSIlQFqUKhYJBMJmP1en0QJiYmEIvFGEpu+/r6YLFY2FFHRweHyWRCe3s7u25qahJb08XOaZ7CbDbzs2AwCGFychKSSwJ2iyU7nU5YRaeBQAA+n09c2QuXy8WtoPKkPlMFVDKpTJDBFxj67bASSJtEq9rEnpBju90OR38/bOIiOl09t4FA1IbGxka0trbyOHD9WjVQKpfKInU47HC53fAPD2PI7xfdeuDxeBDwBzi3rq6OQ6PWwOV1Xy45FApBLpdzk0nlciVWV5/j+34OX99vI7/3DQeFAnY+7aBQPETyxk3eDKVSyRocC1cDpR2T4vX6OlA6xmk+j5P8kTgso1gqga7FxUXOkb7bSHTscsmSwwugXIH0yxfAjwLKIuDg6Bibbz7g85c9Bs7Pz3Me9ZO03z1QDax0+CqdBvkpnpUZsrG1jfT62yuB3MN/ATOZDL+cOygid3KOjc13ePL0Gc8tLCxcAjqv2pRK4NraGr9cPjtF+ec5trK72N39yHPJZLIa+NceipHNZiFdmZ0ScvuHF/epVKoC6IIQjycwPT2N2dlZjI+PVzlcWrqFx48e4u69BxiIpbC0fB93lm9jZWUFo6OjnCOdaXY4NzeHRCKBmZkZRKPRKqBMDPopGAx6aFUCjKI6HAN8JOkI/vlzIOAv6pwpo2FjFGMAAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"文章内容（Newsflow UWP应用）","title":"文章内容（Newsflow UWP应用）","src":"/static/964a91b103bce711133b6d45406cfcdf/267c0/rss-content.png","srcSet":["/static/964a91b103bce711133b6d45406cfcdf/5459c/rss-content.png 285w","/static/964a91b103bce711133b6d45406cfcdf/2cee3/rss-content.png 570w","/static/964a91b103bce711133b6d45406cfcdf/267c0/rss-content.png 1140w","/static/964a91b103bce711133b6d45406cfcdf/96c58/rss-content.png 1216w"],"sizes":["(max-width:","1140px)","100vw,","1140px"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy"},"children":[]},{"type":"text","value":"\n    "}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"figcaption","properties":{"className":["gatsby-resp-image-figcaption"]},"children":[{"type":"text","value":"文章内容（Newsflow UWP应用）"}]},{"type":"text","value":"\n  "}]},{"type":"element","tagName":"p","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"当然，根据认证服务的结果可以发现，博客的RSS还有一些问题，其中比较严重是"},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"文章内容的图片地址是相对地址，而不是绝对地址"}]},{"type":"text","value":"，这造成了包括Read（一个Android RSS应用，"},{"type":"element","tagName":"a","properties":{"href":"https://play.google.com/store/apps/details?id=com.read.app"},"children":[{"type":"text","value":"Google Play"}]},{"type":"text","value":"）等一些工具不能正确显示图片。但是这些问题可能在短时间内无法被解决，因为我目前暂时没有找到有效的、可扩展的方法hook进入Gatsby构建时markdown的渲染流程，并根据我的需求进行修改。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"详细地说，目前，将MD编译成HTML是由"},{"type":"element","tagName":"a","properties":{"href":"https://remark.js.org/"},"children":[{"type":"text","value":"remark"}]},{"type":"text","value":"，以及很多周边插件（例如"},{"type":"element","tagName":"a","properties":{"href":"https://github.com/Gatsbyjs/Gatsby/tree/master/packages/Gatsby-transformer-remark"},"children":[{"type":"text","value":"Gatsby-transformer-remark"}]},{"type":"text","value":"）共同完成的。这些插件都有一些默认行为（例如图片地址是相对地址）等。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"这些默认行为在大多数情况下都是合理的，让开发者能够开箱即用。但是，"},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"约定大于配置的反面就是配置常常不够完善，在遇到少见的需求的时候让开发者感到束手束脚。"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"之前，为了一些特殊需求（例如在markdown里插入React组件（我使用过MDX个人不太好用），给code元素加入一些特殊元素（例如显示语言、行号、复制按钮等）），我多次尝试过hook进remark的编译过程，"},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"在remark进行渲染的时候修改AST，使得进入Gatsby数据源中的htmlAst和html就是经过定制的"}]},{"type":"text","value":"，但是一直没能找到合适的方法。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"后来，这些功能都实现了，但是不够优雅：在代码中，从"},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Gatsby数据源"}]},{"type":"text","value":"中获取remark渲染后的AST，修改AST后再重新使用"},{"type":"element","tagName":"a","properties":{"href":"https://github.com/rehypejs/rehype-react"},"children":[{"type":"text","value":"rehype-react"}]},{"type":"text","value":"渲染（对这里感兴趣的同学可以查看代码的"},{"type":"element","tagName":"a","properties":{"href":"https://github.com/vicblog/VicBlog-Gatsby/blob/master/src/components/Article/ContentDisplay/index.tsx"},"children":[{"type":"text","value":"ArticleContentDisplay"}]},{"type":"text","value":"组件）。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"这样做虽然能够实现需求，但由于在"},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Gatsby的数据源"}]},{"type":"text","value":"中，其htmlAst和html并没有经过定制（定制是在页面渲染的时候执行的），这也造成目前各个方法获得的HTML并不统一。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"没有一个可靠的hook渲染过程的方法，也造成了我没有办法修改remark的默认行为，其中就包含图片地址为相对地址而不是绝对地址这个问题。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"我正在努力想办法解决这个问题，但是看情况短时间内解决希望不大。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"使用国内托管（腾讯云的"},{"type":"element","tagName":"a","properties":{"href":"https://dev.tencent.com/production"},"children":[{"type":"text","value":"CODING个人版"}]},{"type":"text","value":"）"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"博客一直是托管在GitHub Pages上的。GitHub Pages很方便，零开销，在国外用的很广，网络上的教程也到处都是。但是它的问题是在"},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"国内速度非常慢，且非常不稳定"}]},{"type":"text","value":"。即使我的博客的相关文件已经比较小了，但是GitHub Pages在国内的速度也极大地影响了网站的用户体验。要是当某篇文章有图片，那体验就更糟了。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"多亏了我的博客是静态博客，解决这个问题，本质上只需要把文件托管到某个国内访问速度快的类Pages服务上即可解决问题（点"},{"type":"element","tagName":"a","properties":{"href":"/about/project"},"children":[{"type":"text","value":"关于博客"}]},{"type":"text","value":"查看博客工作原理介绍）。我把目标投向了17年参加南京四校Hack.Christmas时赞助商提供的CODING.NET一年免费VIP账号。虽然那时候VIP基本已经过期，但是当时体验还行，并且也发现了它也提供类似GitHub Pages的功能（也叫Pages服务）。于是，我进行了以下操作："}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"在CODING.NET上开启一个repo，存放博客的文件"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"给这个repo开启Pages服务"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"修改"},{"type":"element","tagName":"a","properties":{"href":"https://github.com/vicblog/VicBlog-Gatsby/blob/master/.travis.yml"},"children":[{"type":"text","value":"CI脚本"}]},{"type":"text","value":"，构建后向GitHub和CODING.NET的repo都推送一次"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"经过测试，CODING.NET的体验还是非常良好的，在国内的速度也非常不错，于是："}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"修改DNS，将根记录（ddadaal.me）指向了CODING.NET，二级域名（pages.ddadaal.me）指向原有GitHub Pages repo"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"在GitHub和CODING.NET平台上修改域名设置"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"这样，我的根域名就被解析到CODING.NET提供的Pages服务上。经过测试，网站的速度提高了非常多，国内用户的体验得到了很大的提高。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[]},{"type":"element","tagName":"figure","properties":{"className":["gatsby-resp-image-figure"],"style":""},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1140px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 45.614035087719294%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAACGElEQVQozz2STWvUUBiF8yv8G65c6Ub8A65EEFwKogsp6EZ03YILKS5E66JLi2BLoYvSD2Sq1mKxlqkfjHYc58Nkkkkyk9zcm5tJHm/uiIFwyc0D57znvE6aCLSqyAtJ/VRVZc8g9dkLG0yKibkEmWtSVZCl439cac8o7eNmR0zLnKIocKQStNNt3sR3GeuuhXKdo9Kchf48K95Le1dowaSxSLJyjakIZ5zKmRiBw+Qxg+yQagrOp+EyG+lltsR1eukHtCxJpSAf/UF820aVGsMRr90hXTiDWLpA2vuM1CXCcNL9Qfpzj9KKapyTwQGtaIdQt6yClAWb0TOW+o/oJYPZeOY9/b7D+HiVwm9RmO8siUjaD1n/tcg4m1hO1yP3Oif0Oi61xEG8z43Tm8wPrjL3/jybg4YFVSn43fvKwJ9Yt7q5hnx6BXf5HEerFxHDjhXNTXxOFgYmcGFtPOkucrt9i1feC+69Psvb031kpui5XfQ4Is8zyz0/nmO38QBv6z7rG5dIBl3iZIzn9nGK6XQ2Vl5xGH6kGTZphW3e+fsUqjStCuJh9L/ZymS3O2rwOeuQpl+Io6YxVCEmCSMvwBFCoJRC5cqOXTvIpFmBfJZevQp5blqXkpoVmZhxxkeSaYTlSstl5p/j+z5BEBCOQ9OcNMFqwijE9QOCuI5DWng0GuF5Hn7oo7SyqxUEI9yhzzD20abh2thf49KXMiRk3H0AAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"[站长工具](http://tool.chinaz.com/speedcom/ddadaal.me-pages.ddadaal.me)","title":"[站长工具](http://tool.chinaz.com/speedcom/ddadaal.me-pages.ddadaal.me)","src":"/static/9e63bd84083fee55b22fc0aad93176e0/267c0/speed-comparison.png","srcSet":["/static/9e63bd84083fee55b22fc0aad93176e0/5459c/speed-comparison.png 285w","/static/9e63bd84083fee55b22fc0aad93176e0/2cee3/speed-comparison.png 570w","/static/9e63bd84083fee55b22fc0aad93176e0/267c0/speed-comparison.png 1140w","/static/9e63bd84083fee55b22fc0aad93176e0/47d67/speed-comparison.png 1220w"],"sizes":["(max-width:","1140px)","100vw,","1140px"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy"},"children":[]},{"type":"text","value":"\n    "}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"figcaption","properties":{"className":["gatsby-resp-image-figcaption"]},"children":[{"type":"text","value":"[站长工具](http://tool.chinaz.com/speedcom/ddadaal.me-pages.ddadaal.me)"}]},{"type":"text","value":"\n  "}]},{"type":"element","tagName":"p","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"多语言环境下文章地址改进"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"之前，为了支持多语言，本网站的所有文章的地址末尾都增加了语言（cn/en）为了表示这个文章的语言是什么，例如"},{"type":"element","tagName":"a","properties":{"href":"/about/me"},"children":[{"type":"text","value":"关于我"}]},{"type":"text","value":"就有两个版本，"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"/about/me/cn"}]},{"type":"text","value":"（中文）和"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"/about/me/en"}]},{"type":"text","value":"（英文），另外对"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"/about/me"}]},{"type":"text","value":"这种根路径增加了"},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"客户端的跳转"}]},{"type":"text","value":"（即在浏览器执行了JS进行跳转，而不是通过服务器发送301（Moved Permanently）的响应。对于静态博客，服务器发送301是不可能的，因为服务器端不能执行这么“复杂”的逻辑）到"},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"本文章的所有版本的第一种语言版本"}]},{"type":"text","value":"（知道你对第一种语言版本感到疑惑，继续往下看）。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"这样做有2个问题："}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"对于所有文章，包括占大多数的只有一种语言版本的文章，其地址栏最后都有语言字符串，造成路径不必要的太长；"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"这个“第一种语言版本”的结果每次执行可能是不相同的，有可能造成根路径在每次更新后都出现变化（没有验证过，只是存在这种可能）。"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"我在最近也重新设计了路径的计算方法，较好的解决了这个问题。以id为"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"an-article"}]},{"type":"text","value":"的、有两种语言版本（"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"cn"}]},{"type":"text","value":"和"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"en"}]},{"type":"text","value":"）文章来举例子："}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"首先，对一篇文章的所有语言版本，"},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"根据lang的字典序进行排序"}]},{"type":"text","value":"，使得每次所有版本的顺序都是相同的，解决了第二个问题"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"例子中，顺序为"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"[cn, en]"}]},{"type":"text","value":"；"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"选取中文版本（"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"cn"}]},{"type":"text","value":"）的文章，或者如果中文版本不存在的话，选择第一个版本（由于所有版本的顺序是相同的，第一个版本也总是相同的），生成根路径"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"/articles/${articleId}"}]},{"type":"text","value":"的页面"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"例子中，选择了中文（"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"cn"}]},{"type":"text","value":"）版本生成"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"/article/an-article"}]},{"type":"text","value":"的页面；"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"生成"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"/articles/${articleId}/${上一步生成的版本的语言}"}]},{"type":"text","value":"到"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"/articles/${articleId}"}]},{"type":"text","value":"的客户端跳转"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"例子中，生成了"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"/articles/an-article/cn"}]},{"type":"text","value":"到"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"/articles/an-article"}]},{"type":"text","value":"的跳转"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"对其他所有语言，生成"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"/articles/${articleId}/${语言}"}]},{"type":"text","value":"的页面。"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"通过这样，可以保证博客中大多数单语言的文章都生成在"},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"根路径"}]},{"type":"text","value":"，不再有碍眼的多余的语言字符串，同时也保证了多语言功能和向前兼容性。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"举几个例子："}]},{"type":"text","value":"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{"type":"element","tagName":"table","properties":{},"children":[{"type":"element","tagName":"thead","properties":{},"children":[{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"th","properties":{},"children":[{"type":"text","value":"文章"}]},{"type":"element","tagName":"th","properties":{},"children":[{"type":"text","value":"语言"}]},{"type":"element","tagName":"th","properties":{},"children":[{"type":"text","value":"之前的路径"}]},{"type":"element","tagName":"th","properties":{},"children":[{"type":"text","value":"现在的路径"}]}]}]},{"type":"element","tagName":"tbody","properties":{},"children":[{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"关于我"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"cn"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"/about/me/cn"}]}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"/about/me"}]}]}]},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"关于我"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"en"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"/about/me/en"}]}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"/about/me/en"}]}]}]},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"2018年总结"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"cn"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"/articles/summary-for-2018/cn"}]}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"/articles/summary-for-2018"}]}]}]},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"Simstate and Why"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"en"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"/articles/simstate-and-why/en"}]}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"/articles/simstate-and-why"}]}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"最后提一下，一般来说，网站要支持多种语言，目前大家通常使用以下的两种方法实现，但是由于他们都需要特别的处理，也为了能够"},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"热切换语言"}]},{"type":"text","value":"，最后采用了以上这个比较简单的方法（即在路径最后增加语言表示）实现："}]},{"type":"text","value":"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{"type":"element","tagName":"table","properties":{},"children":[{"type":"element","tagName":"thead","properties":{},"children":[{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"th","properties":{},"children":[{"type":"text","value":"方法"}]},{"type":"element","tagName":"th","properties":{},"children":[{"type":"text","value":"解释"}]},{"type":"element","tagName":"th","properties":{},"children":[{"type":"text","value":"例子"}]},{"type":"element","tagName":"th","properties":{},"children":[{"type":"text","value":"问题"}]}]}]},{"type":"element","tagName":"tbody","properties":{},"children":[{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"二级域名"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"每个语言的子网站都有自己的二级域名"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"淘宝"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"本质上是两个网站，当一种语言的页面不存在时，需要做跳转，懒得维护"}]}]},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"子页面"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"每个语言采用类似"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"https://domain.com/{zh-CN, en-US}/path/to/page"}]},{"type":"text","value":"的方法，通过路径的第一个部分区分不同语言"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"微软官网（"},{"type":"element","tagName":"a","properties":{"href":"https://www.microsoft.com/en-us/locale.aspx?absoluteReturnUrl=https%3a%2f%2fwww.microsoft.com%2fzh-cn"},"children":[{"type":"text","value":"切换语言的页面"}]},{"type":"text","value":"）"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"处理路径时（例如导航栏高亮），需要单独切分掉"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"pathname"}]},{"type":"text","value":"的第一部分；当一种语言的页面不存在时，需要做跳转"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"使用自己开发的"},{"type":"element","tagName":"a","properties":{"href":"https://github.com/ddadaal/simstate"},"children":[{"type":"text","value":"simstate"}]},{"type":"text","value":"进行状态管理"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"博客一开始是使用"},{"type":"element","tagName":"a","properties":{"href":"https://github.com/jamiebuilds/unstated"},"children":[{"type":"text","value":"unstated"}]},{"type":"text","value":"进行状态管理的。这个库非常的简单易用，很符合react的理念，于是当时我非常喜爱这个库。但是随着后来hooks的推广和unstated迟迟没有跟进hooks等原因（其实已经跟进了只是当时我的不知道……），我认为是时候写一个自己的状态管理库了。这之后故事可以查看"},{"type":"element","tagName":"a","properties":{"href":"/articles/simstate-and-why"},"children":[{"type":"text","value":"Simstate and Why"}]},{"type":"text","value":"文章，这里就不说了。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"在v3.0时，我重构了simstate，完全抛弃了class的概念，完全使用React原生的hook就可以完成状态管理。而博客就是第一个完全采用simstate v3.0的项目。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[]},{"type":"element","tagName":"figure","properties":{"className":["gatsby-resp-image-figure"],"style":""},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1140px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 50.877192982456144%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABb0lEQVQoz41SWU7EMBTrPaZL9qRp0sx0gEFI3P9Yxq+FEQKxfFhRFdvx82tX64Z1e0ZrV1zyjOgclNJ3aK0xTQohRMzLgqU0nLcbzrVh9g7WWih98ARdsBFVCNsVjQKnFfq+xzAMGN7P/nSCCwGlFjjrkdYrPB/w5I5y/8EnOuN5ERNystDOY1AKyjgMkswYTJanNTvZMY3xAaHQOAeoFJnO7DqZYjcMNEzLGbldsLaKVBYic7SEmMJOVjSWFI51eH6HVLCsFXNdYUMihzU5ywAc2XmPvL2gPb/i6fZAswITA8WG/fB1miml7obOsjctSY904zhinATTjs5RFBKTbY9Y5sQO9U46+iOR+OhHv9/1Q3/v9ys6z1dzubKXCi8dMbZlKienjMJEkmA3H/9GJ6LIrWX2IePqGKHFxJp9GaM9lvNZJEl+NmSqXC+o54ZYWDK7mUb5Zb6P8y9D2VqhYV4b/Jzh5uUQfU70xeQ3wzcgPRkAYWWn5gAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"使用simstate设计Store（左）和使用Store（右）","title":"使用simstate设计Store（左）和使用Store（右）","src":"/static/01fa7432bedf473eff06b9ff424a1631/267c0/simstate-in-action.png","srcSet":["/static/01fa7432bedf473eff06b9ff424a1631/5459c/simstate-in-action.png 285w","/static/01fa7432bedf473eff06b9ff424a1631/2cee3/simstate-in-action.png 570w","/static/01fa7432bedf473eff06b9ff424a1631/267c0/simstate-in-action.png 1140w","/static/01fa7432bedf473eff06b9ff424a1631/d69cc/simstate-in-action.png 1687w"],"sizes":["(max-width:","1140px)","100vw,","1140px"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy"},"children":[]},{"type":"text","value":"\n    "}]},{"type":"text","value":"\n    "},{"type":"element","tagName":"figcaption","properties":{"className":["gatsby-resp-image-figcaption"]},"children":[{"type":"text","value":"使用simstate设计Store（左）和使用Store（右）"}]},{"type":"text","value":"\n  "}]},{"type":"element","tagName":"p","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"在使用新版本的时候，我也积累了一些在项目中正确使用此项目的经验，例如说："}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Store取名最好是"},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"大写字母"}]},{"type":"text","value":"开头，因为在使用的时候经常出现"},{"type":"element","tagName":"code","properties":{"className":["dark-default-dark"],"dataLanguage":"ts","dataIndex":"0"},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"const"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk12"]},"children":[{"type":"text","value":"aStore"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk11"]},"children":[{"type":"text","value":"useStore"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk12"]},"children":[{"type":"text","value":"AStore"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":";"}]}]},{"type":"text","value":"的代码，若使用小写字母开头，这代码会编译失败。这也可以帮助同时使用多个Store的情况时，区分不同的Store实例；"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"如何写一个专门的Store（例如博客项目的"},{"type":"element","tagName":"a","properties":{"href":"https://github.com/vicblog/VicBlog-Gatsby/blob/master/src/stores/LocationStore.tsx"},"children":[{"type":"text","value":"LocationStore"}]},{"type":"text","value":"）来管理浏览器history"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"在把Store和自己的hook（例如"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"useCallback"}]},{"type":"text","value":"等）进行组合的时候，需要把Store实例加为hook的一个依赖，因为Store实例是"},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"不可变的"}]}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"这些常见问题也写到了"},{"type":"element","tagName":"a","properties":{"href":"https://github.com/ddadaal/simstate"},"children":[{"type":"text","value":"simstate项目的README"}]},{"type":"text","value":"中，也是给未来自己（和其他人，如果有人在用的话）带来方便，帮助解决这种常见问题。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"其他值得提到的近期的修正（太远的我也记不住了……）"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"修正了错误的授权协议（"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"BY CC-SA 4.0"}]},{"type":"text","value":" => "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"CC BY-SA 4.0"}]},{"type":"text","value":"）"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"最后更新时间和文章发表时间正确支持了多时区（时间将会以用户的本地时区进行显示）"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"在CI上构建时，机器给出的时间是UTC时间，如果不经过处理就显示会让人产生误解"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"修正了一些没有正确使用的HTML元素的属性造成可访问性（accessibility）问题"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"例如，在文章列表界面中用鼠标点击文章标题，可以进入文章内容。但是使用vimium等工具在文章列表界面导航时，会发现文章项的标题的链接不能点击。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"这是因为在实现时，点击标题进入文章是通过绑定"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"onClick"}]},{"type":"text","value":"事件跳转实现，不符合HTML标准使用"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"a"}]},{"type":"text","value":"标签的"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"href"}]},{"type":"text","value":"属性进行跳转。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"修改后，vimium恢复了正常。"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"问题和后续计划"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"去年"},{"type":"element","tagName":"a","properties":{"href":"/articles/gatsby-powered-vicblog-online"},"children":[{"type":"text","value":"Gatsby博客上线"}]},{"type":"text","value":"的时候提到："}]},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"博客的大厦已经基本建好，接下来只需要小修小补即可。"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"其实这一年中博客的发展和变化还是比较大的，已有的功能继续完善，没有或者缺乏的功能也正在加入。在接下来，我会在以下几个方面继续完善我的博客："}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"文章数量和质量"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"毕竟博客的本职工作的写文章（而不是像我这样大多数时间在写网站本身……），以后我会带来尽可能多尽可能高质量的原创文章。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"重构样式和完善UI设计"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"目前博客是使用大名鼎鼎的"},{"type":"element","tagName":"a","properties":{"href":"https://getbootstrap.com/"},"children":[{"type":"text","value":"bootstrap"}]},{"type":"text","value":"的组件库进行设计的。虽然很方便，bootstrap也还算比较耐看，但是，由于要将使用SCSS编写的bootstrap和我偏好的CSS-in-JS方案（例如"},{"type":"element","tagName":"a","properties":{"href":"https://www.styled-components.com/"},"children":[{"type":"text","value":"styled-components"}]},{"type":"text","value":"）组合起来使用，造成了一些问题："}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"目前我的博客的样式有"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"CSS"}]},{"type":"text","value":"，bootstrap带来的"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"SCSS"}]},{"type":"text","value":"和分散在各个组件里的"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"styled-components"}]},{"type":"text","value":"组件，非常的混乱，不容易维护（例如说某个共用颜色，必须要在多个地方定义多次）；"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"由于上个原因，没有一个中心化的配置，很难实现"},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"黑暗模式"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"基于传统的CSS/SCSS的"},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"全局的样式解决方案"}]},{"type":"text","value":"和"},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"组件化"}]},{"type":"text","value":"的React和CSS-in-JS是两种不一样的思维方式，让开发者有一种"},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"思维分裂"}]},{"type":"text","value":"的感觉"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"例如：对于重用一个样式的需求，"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"使用CSS/SCSS的思维方式是写一个类（使用BEM命名规范规避类型冲突），然后通过组件的"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"className"}]},{"type":"text","value":"组合样式；"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"而"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"styled-components"}]},{"type":"text","value":"的思维方式，是在一个已有的样式的组件上，通过"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"styled(Component)` /** styles **/ `"}]},{"type":"text","value":"进行扩展。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"这个"},{"type":"element","tagName":"a","properties":{"href":"https://github.com/vicblog/VicBlog-Gatsby/blob/master/src/components/UI/ListGroup/ListGroupHeader.tsx"},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"ListGroupHeader"}]}]},{"type":"text","value":"组件就是强行使用组件化的方式重用CSS的样式，这种模板代码非常的浪费时间和不灵活。"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"bootstrap看厌了，想看点新鲜的 :😄:"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"5月份的时候，我尝试在"},{"type":"element","tagName":"a","properties":{"href":"https://styled-system.com/"},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"styled-system"}]}]},{"type":"text","value":"的支持下写自己的UI库"},{"type":"element","tagName":"a","properties":{"href":"https://github.com/ddadaal/vicui"},"children":[{"type":"text","value":"vicui"}]},{"type":"text","value":"。组件基本都完成了，但是在使用的时候遇到了"},{"type":"element","tagName":"a","properties":{"href":"https://github.com/ddadaal/vicui/issues/1"},"children":[{"type":"text","value":"很奇怪的问题"}]},{"type":"text","value":"，造成我完全无法在其他项目中使用。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"同时，我在项目中采用了将"},{"type":"element","tagName":"a","properties":{"href":"https://rebassjs.org/theming/"},"children":[{"type":"text","value":"Rebass"}]},{"type":"text","value":"这样的"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"primitive UI components"}]},{"type":"text","value":"和"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"CSS"}]},{"type":"text","value":"混用的方式，使得不仅在保证在React中使用方便和可扩展性，同时在以后迁移到React生态圈之外时，已有的CSS的可以重用，但是在"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"无法避免全局样式类名"}]},{"type":"text","value":"、"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"对用户公开多大自定义样式的能力"}]},{"type":"text","value":"等问题上也存在一些问题。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"对于样式，这个前端”永远的难题“，我还需要更多的学习和实践。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{"start":3},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"补充功能"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"静态博客无法单独实现"},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"所有依赖于服务器的功能"}]},{"type":"text","value":"，包括访客统计、评论、点赞等功能。我已经使用"},{"type":"element","tagName":"a","properties":{"href":"https://github.com/gitalk/gitalk"},"children":[{"type":"text","value":"gitalk"}]},{"type":"text","value":"解决了评论问题，解决地还算满意；使用"},{"type":"element","tagName":"a","properties":{"href":"https://www.cnzz.com"},"children":[{"type":"text","value":"CNZZ"}]},{"type":"text","value":"解决访客统计功能，虽说是能统计，但是它甚至没有提供API，不能编程实现网站访客的显示，更别提分文章的统计了；至于点赞，这还是算了吧……"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"要解决这个问题，可以自己写后端，将这个博客变成一个SPA。目前使用场景非常适合微服务，即每个功能之间是的独立的。例如，对访客统计写一个服务，对点赞写一个服务，各个服务之间相互独立，独立开发、渐进部署。我也正在学习这个方面的技术，期待早日能有一个可靠的、可扩展的、博客专用的基础设施和服务能够上线。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{"start":4},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"一些其他问题：例如中文字数统计不正确、之上提到的自定义MD渲染过程等"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"感谢！"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"博客已经走过一年了。在这一年中感谢所有支持我的博客的读者和网友，感谢你们对我文章的支持！我也会在之后继续完善博客的内容、设计和功能，让博客更加地完善、丰富和易用！"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"style","properties":{"className":["grvsc-styles"]},"children":[{"type":"text","value":"\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .dark-default-dark {\n    background-color: #1E1E1E;\n    color: #D4D4D4;\n  }\n  .dark-default-dark .mtk4 { color: #569CD6; }\n  .dark-default-dark .mtk1 { color: #D4D4D4; }\n  .dark-default-dark .mtk12 { color: #9CDCFE; }\n  .dark-default-dark .mtk11 { color: #DCDCAA; }\n  .dark-default-dark .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n"}]}],"data":{"quirksMode":false}},"headings":[{"depth":1,"value":"前言","slug":"前言-1"},{"depth":1,"value":"更新","slug":"更新"},{"depth":2,"value":"RSS恢复支持","slug":"rss恢复支持"},{"depth":2,"value":"使用国内托管（腾讯云的CODING个人版）","slug":"使用国内托管（腾讯云的coding个人版）"},{"depth":2,"value":"多语言环境下文章地址改进","slug":"多语言环境下文章地址改进"},{"depth":2,"value":"使用自己开发的simstate进行状态管理","slug":"使用自己开发的simstate进行状态管理"},{"depth":2,"value":"其他值得提到的近期的修正（太远的我也记不住了……）","slug":"其他值得提到的近期的修正（太远的我也记不住了）"},{"depth":1,"value":"问题和后续计划","slug":"问题和后续计划"},{"depth":1,"value":"感谢！","slug":"感谢！"}]}},"staticQueryHashes":["3830103294"]}